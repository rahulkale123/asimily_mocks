<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Asimily</title>
    <link rel="stylesheet" type="text/css" href="css/stroke7.css" />
    <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/nanoscroller.css" />
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="css/style.css" type="text/css" />
    <link rel="stylesheet" href="css/asimily.css" type="text/css" />
</head>
<style type="text/css">
.axis path,
.axis line {
    fill: none;
}

.y.axis path {
    display: none;
}

.brush .extent {
    fill-opacity: .125;
    shape-rendering: crispEdges;
}

.resize {
    display: inline !important;
    /* show when empty */
    fill: #7A7A7A;
    fill-opacity: 1;
    stroke: #7A7A7A;
    stroke-width: 2px;
}

.bar {
    /*shape-rendering: crispEdges;*/
}
</style>
<style type="text/css">
#sequence {
    width: 600px;
    height: 70px;
}

#legend {
    padding: 10px 0 0 3px;
}

#sequence text,
#legend text {
    font-weight: 600;
    fill: #fff;
}

#sidebar {
    position: absolute;
    top: 50px;
    right: 50px;
}

#sunburst {
    position: relative;
}

#sunburst path {
    stroke: #fff;
}

#explanation {
    position: absolute;
    top: 260px;
    left: 245px;
    width: 160px;
    font-size: 20px;
    text-align: center;
    color: #666;
    z-index: -1;
}

#percentage {
    font-size: 40px;
}

#scroll {
    height: 280px;
    width: 600px;
    border: 1px solid #ccc;
    overflow: auto;
    margin-left: 100px;
}


#chart text {
    font-size: 10px;
}
</style>

<body>
    <div class="am-wrapper am-nosidebar-left">
        <nav class="navbar navbar-default navbar-fixed-top am-top-header">
            <div class="container-fluid">
                <div class="navbar-header">
                    <div class="page-title"><span>No Sidebar Left</span></div>
                    <a href="index.html" class="navbar-brand"></a>
                </div>
                <a href="#" data-toggle="collapse" data-target="#am-navbar-collapse" class="am-toggle-top-header-menu collapsed"><span class="icon s7-angle-down"></span></a>
                <div id="am-navbar-collapse" class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right am-user-nav">
                        <li class="dropdown"><a href="#" data-toggle="dropdown" role="button" aria-expanded="false" class="dropdown-toggle"><img src="img/avatar.png"><span class="user-name">Samantha Amaretti</span><span class="angle-down s7-angle-down"></span></a>
                            <ul role="menu" class="dropdown-menu">
                                <li><a href="#"> <span class="icon s7-user"></span>My profile</a></li>
                                <li><a href="#"> <span class="icon s7-config"></span>Settings</a></li>
                                <li><a href="javascript:void(0);" data-toggle="modal" data-target="#change-password"> <span class="icon s7-key"></span>Change Password</a></li>
                                <li><a href="#"> <span class="icon s7-power"></span>Sign Out</a></li>
                            </ul>
                        </li>
                    </ul>
                    <ul class="nav navbar-nav am-nav-right">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="summary.html">Summary</a></li>
                        <li><a href="configuration.html">Configuration</a></li>
                        <li><a href="admin-module.html">Admin Module</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="am-content">
            <div class="main-content">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="widget widget-fullwidth line-chart">
                            <div class="widget-head">
                                <div class="tools"><span class="icon s7-upload"></span><span class="icon s7-edit"></span><span class="icon s7-close"></span></div><span class="title">Manufacturers</span>
                            </div>
                            <div class="chart-container" style="padding-left: 10px;">
                                <div id="one"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="widget widget-fullwidth line-chart">
                            <div class="widget-head">
                                <div class="tools"><span class="icon s7-upload"></span><span class="icon s7-edit"></span><span class="icon s7-close"></span></div><span class="title">Operating Systems</span>
                            </div>
                            <div class="chart-container" style="padding-left: 10px;height: 250px;overflow: hidden;">
                                <div id="two"><img class="img-responsive" src="img/asimily_graph.png"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="margin-top: 15px;">
                    <div class="col-sm-6">
                        <div class="widget widget-fullwidth line-chart">
                            <div class="widget-head">
                                <div class="tools"><span class="icon s7-upload"></span><span class="icon s7-edit"></span><span class="icon s7-close"></span></div><span class="title">Device Types</span>
                            </div>
                            <div class="chart-container" style="padding-left: 10px;height: 250px;overflow: hidden;">
                                <div id="three">
                                    <div id="two"><img class="img-responsive" src="img/asimily_graph.png"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="widget widget-fullwidth line-chart">
                            <div class="widget-head">
                                <div class="tools"><span class="icon s7-upload"></span><span class="icon s7-edit"></span><span class="icon s7-close"></span></div><span class="title">Utilization</span>
                            </div>
                            <div class="chart-container" style="padding-left: 10px;height: 250px;overflow: hidden;">
                                <div id="four">
                                    <div id="two"><img class="img-responsive" src="img/asimily_graph.png"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6" ">
                        <div class="widget widget-fullwidth line-chart ">
                            <div class="widget-head ">
                                <div class="tools ">
                                    <!-- <input type="checkbox " id="togglelegend "> Devices -->
                                </div><span class="title ">Manufacturers</span>
                            </div>
                            <div class="chart-container " style="position: relative; ">
                                    <div id="sequence "></div>
                                <div id="sidebar " >
                                </div>
                                    <div id="sunburst ">
                                        <div id="explanation " style="visibility: hidden; ">
                                            <span id="percentage "></span>
                                            <br/> Devices
                                        </div>
                                    </div>
                                </div>
                                <div id="sidebar ">
                                    <br/>
                                    <div id="legend " style="visibility: hidden; "></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 ">
                            <div class="widget widget-fullwidth line-chart ">
                                <div class="widget-head ">
                                    <span class="title ">Device Table</span>
                                </div>
                                <div class="chart-container " style="height: 675px;overflow: hidden;background-color: white;padding: 5px ">
                                    <div class="row " style="margin-bottom: 20px; ">
                                        <div class="col-md-11 ">
                                            <div class="input-group ">
                                                <span class="input-group-addon "><i class="s7-search "></i></span>
                                                <input type="text " placeholder="Search... " class="form-control ">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix contain-sides ">
                                        <div class="left-side ">
                                            <div class="table-responsive ">
                                                <table class="table table-striped table-fw-widget table-hover special-scroll ">
                                                    <thead>
                                                        <tr>
                                                            <th width="20% ">Name</th>
                                                            <th width="25% ">Manufacturer</th>
                                                            <th width="10% ">Device Type</th>
                                                            <th width="10% ">Date</th>
                                                            
                                                            
                                                        </tr>
                                                    </thead>
                                                    <tbody class="no-border-x ">
                                                        <tr>
                                                            <td><a class="toggle-details ">192.168.5.1</a></td>
                                                            <td>Motorola Mobility LLC, a Lenovo Company</td>
                                                            <td>63e8ec3</td>
                                                            <td>Aug 6, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">10.122.15.1</a></td>
                                                            <td>Microsoft</td>
                                                            <td>4cc1bc2</td>
                                                            <td>Jul 28, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">12.372.123.1</a></td>
                                                            <td>Xiaomi</td>
                                                            <td>5477993</td>
                                                            <td>Jul 15, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">83.372.12.1</a></td>
                                                            <td>Xerox</td>
                                                            <td>8cb98ec</td>
                                                            <td>Jun 30, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">255.255.255.0</a></td>
                                                            <td>Suzuka</td>
                                                            <td>63e8ec3</td>
                                                            <td>Aug 6, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">12.123.128.12</a></td>
                                                            <td>Hyperware</td>
                                                            <td>4cc1bc2</td>
                                                            <td>Jul 28, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">73.72.1.2</a></td>
                                                            <td>Panacea</td>
                                                            <td>5477993</td>
                                                            <td>Jul 15, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">10.37.1.3</a></td>
                                                            <td>Alchemist</td>
                                                            <td>8cb98ec</td>
                                                            <td>Jun 30, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">10.37.1.3</a></td>
                                                            <td>Alchemist</td>
                                                            <td>63e8ec3</td>
                                                            <td>Aug 6, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">10.37.1.3</a></td>
                                                            <td>Panacea</td>
                                                            <td>4cc1bc2</td>
                                                            <td>Jul 28, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">10.37.1.3</a></td>
                                                            <td>Microsoft</td>
                                                            <td>5477993</td>
                                                            <td>Jul 15, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td><a class="toggle-details ">10.37.1.3</a></td>
                                                            <td>Xerox</td>
                                                            <td>8cb98ec</td>
                                                            <td>Jun 30, 2015</td>
                                                            
                                                            
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="right-side ">
                                            <div class="details ">
                                                <div class="detail-header ">
                                                    <!-- <a id="close-details pull-right "><span class="s7-close "></span>Close</a> -->
                                                    <div style="margin-bottom: 12px; ">
                                                        <span>192.168.5.1</span>
                                                        <div class="pull-right ">
                                                            <!-- <a class="btn text-info "><i class="fa fa-eye fa-fw fa-2x "></i></a> -->
                                                            <a class="btn btn-sm btn-info ">Details</a>
                                                            <a class="btn btn-sm btn-danger close-details ">Close</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="detail-body ">
                                                <table class="table table-bordered table-striped " style="margin-top: 46px; ">
                                                    <thead>
                                                        <tr>
                                                            <th>Name</th>
                                                            <th>Detail</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>IP</td>
                                                            <td>10.90.96.107</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Manufacturer</td>
                                                            <td>Motorola Mobility LLC, a Lenovo Company</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Mac address</td>
                                                            <td>40:78:6a:4e:fb:a6</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Hostname</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Serial number</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>IP</td>
                                                            <td>10.90.96.107</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Mac address</td>
                                                            <td>40:78:6a:4e:fb:a6</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Manufacturer</td>
                                                            <td>Motorola Mobility LLC, a Lenovo Company</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Hostname</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Serial number</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>IP</td>
                                                            <td>10.90.96.107</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Mac address</td>
                                                            <td>40:78:6a:4e:fb:a6</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Manufacturer</td>
                                                            <td>Motorola... </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Patient Impact Details</td>
                                                            <td> Question : What is the criticality of this device? Answer : 5, Question : What is the FDA class of this device? Answer : 2</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Serial number</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>IP</td>
                                                            <td>10.90.96.107</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Mac address</td>
                                                            <td>40:78:6a:4e:fb:a6</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Manufacturer</td>
                                                            <td>Motorola... </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Patient Impact Details</td>
                                                            <td> Question : What is the criticality of this device? Answer : 5, Question : What is the FDA class of this device? Answer : 2</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Serial number</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>IP</td>
                                                            <td>10.90.96.107</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Mac address</td>
                                                            <td>40:78:6a:4e:fb:a6</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Manufacturer</td>
                                                            <td>Motorola... </td>
                                                        </tr>
                                                        <tr>
                                                            <td>Hostname</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Serial number</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>IP</td>
                                                            <td>10.90.96.107</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Mac address</td>
                                                            <td>40:78:6a:4e:fb:a6</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Patient Impact Details</td>
                                                            <td> Question : What is the criticality of this device? Answer : 5, Question : What is the FDA class of this device? Answer : 2</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Hostname</td>
                                                            <td>--</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Serial number</td>
                                                            <td>--</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <nav class="am-right-sidebar ">
        <div class="sb-content ">
            <div class="user-info "><img src="img/avatar.png "><span class="name ">Samantha Amaretti<span class="status "></span></span><span class="position ">Art Director</span></div>
            <p style="text-align: center; color: white; ">Settings will appear here</p>
        </div>
    </nav>
    </div>
    <!-- Critical Count -->
    <div id="critical-count " tabindex="-1 " role="dialog " class="modal fade modal-colored-header ">
        <div class="modal-dialog modal-lg ">
            <div class="modal-content ">
                <div class="modal-header ">
                    <button type="button " data-dismiss="modal " aria-hidden="true " class="close "><i class="icon s7-close "></i></button>
                    <h3 class="modal-title ">GE CardioLab (192.168.5.1)</h3>
                </div>
                <div class="modal-body ">
                    <table class="table table-asimily ">
                        <thead>
                            <tr>
                                <th>Application/Device</th>
                                <th>CVE ID</th>
                                <th>CVE Title</th>
                                <th>Vulnerability Score</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Java Application</td>
                                <td>CVE-2013-56</td>
                                <td>Improper Restriction of Operations within the Bounds of a Memory Buffer (2.11)</td>
                                <td>1.5</td>
                            </tr>
                            <tr>
                                <td>Adobe Flash</td>
                                <td>CVE-2014-965</td>
                                <td></td>
                                <td>7.5</td>
                            </tr>
                            <tr>
                                <td>OS</td>
                                <td>CVE-2014-67</td>
                                <td></td>
                                <td>9</td>
                            </tr>
                            <tr>
                                <td>Keys stored in plaintext</td>
                                <td>CVE-2016-543</td>
                                <td></td>
                                <td>3</td>
                            </tr>
                            <tr>
                                <td>Is the device publicly availabe for purchase</td>
                                <td>CVE-2017-123</td>
                                <td></td>
                                <td>4</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer ">
                    <button type="button " data-dismiss="modal " class="btn btn-default ">Cancel</button>
                    <button type="button " data-dismiss="modal " class="btn btn-primary ">Ok</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Device Count -->
    <!-- Fix Alert -->
    <div id="fixVulnerability " tabindex="-1 " role="dialog " class="modal fade ">
        <div class="modal-dialog ">
            <div class="modal-content modal-sm ">
                <div class="modal-body ">
                    <div class="text-center ">
                        <div class="i-circle primary "><i class="icon s7-tools text-success "></i></div>
                        <h4>Alert!</h4>
                        <p>Are you sure you want to mark these vulnerabilities as fixed?</p>
                        <textarea class="form-control " placeholder="Action Taken... " rows="5 "></textarea>
                    </div>
                </div>
                <div class="modal-footer ">
                    <button type="button " data-dismiss="modal " class="btn btn-success btn-shade1 ">Cancel</button>
                    <button type="button " data-dismiss="modal " class="btn btn-success btn-shade1 ">Proceed</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Fix Alert -->
    <div id="fixRecall " tabindex="-1 " role="dialog " class="modal fade ">
        <div class="modal-dialog ">
            <div class="modal-content modal-sm ">
                <div class="modal-body ">
                    <div class="text-center ">
                        <div class="i-circle primary "><i class="icon s7-tools text-success "></i></div>
                        <h4>Alert!</h4>
                        <p>Are you sure you want to mark these devices as fixed?</p>
                        <textarea class="form-control " placeholder="Action Taken... " rows="5 "></textarea>
                    </div>
                </div>
                <div class="modal-footer ">
                    <button type="button " data-dismiss="modal " class="btn btn-success btn-shade1 ">Cancel</button>
                    <button type="button " data-dismiss="modal " class="btn btn-success btn-shade1 ">Proceed</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Assign Modal -->
    <div id="assignModal " tabindex="-1 " role="dialog " class="modal fade ">
        <div class="modal-dialog ">
            <div class="modal-content ">
                <div class="modal-body form-horizontal ">
                    <div class="form-group ">
                        <label class="col-sm-3 control-label ">User:</label>
                        <div class="col-sm-9 ">
                            <select class="form-control ">
                                <option>User 1</option>
                                <option>User 2</option>
                                <option>User 3</option>
                                <option>User 4</option>
                                <option>User 5</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group ">
                        <label class="col-sm-3 control-label ">Due Date:</label>
                        <div class="col-sm-9 ">
                            <div class="input-group ">
                                <input type="text " class="form-control "><span class="input-group-addon "><i class="fa fa-calendar "></i></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer ">
                    <button type="button " data-dismiss="modal " class="btn btn-success btn-default ">Cancel</button>
                    <button type="button " data-dismiss="modal " class="btn btn-success btn-success ">Confirm</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Change Password -->
    <div id="change-password " tabindex="-1 " role="dialog " class="modal fade modal-colored-header ">
        <div class="modal-dialog ">
            <div class="modal-content ">
                <div class="modal-header ">
                    <button type="button " data-dismiss="modal " aria-hidden="true " class="close "><i class="icon s7-close "></i></button>
                    <h3 class="modal-title ">Change Password</h3>
                </div>
                <div class="modal-body form-horizontal ">
                    <div class="form-group ">
                        <label class="col-sm-4 control-label ">Enter Old Password:</label>
                        <div class="col-sm-8 ">
                            <input type="password " class="form-control " />
                        </div>
                    </div>
                    <div class="form-group ">
                        <label class="col-sm-4 control-label ">Enter New Password:</label>
                        <div class="col-sm-8 ">
                            <input type="password " class="form-control " />
                        </div>
                    </div>
                    <div class="form-group ">
                        <label class="col-sm-4 control-label ">Confirm New Password:</label>
                        <div class="col-sm-8 ">
                            <input type="password " class="form-control " />
                        </div>
                    </div>
                </div>
                <div class="modal-footer ">
                    <button type="button " data-dismiss="modal " class="btn btn-default ">Cancel</button>
                    <button type="button " data-dismiss="modal " class="btn btn-primary ">Change Password</button>
                </div>
            </div>
        </div>
    </div>
    <script src="js/jquery.min.js " type="text/javascript "></script>
    <script src="js/jquery.nanoscroller.min.js " type="text/javascript "></script>
    <script src="js/main.js " type="text/javascript "></script>
    <script src="js/bootstrap.min.js " type="text/javascript "></script>
    <script src="js/d3.js "></script>
    <script type="text/javascript ">
    $('.toggle-details').click(function() {
        $('.left-side').toggleClass("five-o ");
        $('.right-side').toggleClass("five-o ");
    });
    $('.close-details').click(function() {
        $('.left-side').toggleClass("five-o ");
        $('.right-side').toggleClass("five-o ");
    });
    </script>
    <script src="one.js " type="text/javascript "></script>
    <!-- <script src="two.js " type="text/javascript "></script>
    <script src="three.js " type="text/javascript "></script>
    <script src="four.js " type="text/javascript "></script> -->
    
    <script>
    // Dimensions of sunburst.
    var width = 650;
    var height = 600;
    var radius = Math.min(width, height) / 2;

    // Breadcrumb dimensions: width, height, spacing, width of tip/tail.
    var b = {
        w: 150,
        h: 25,
        s: 5,
        t: 10
    };

    // Mapping of step names to colors.
    var colors = {
        "device risks ": "#E87B39 ",
        "high ": "#F15A5A ",
        "medium ": "#F0C419 ",
        "low ": "4EBA6F ",
        "anomalies ": "#2D95BF ",
        "likelihood ": "#955BA5 ",
        "FTP to external IPs ": "#37B7EB ",
        "Operational Warning ": "#37B7EB ",
        "Botnet ": "#37B7EB ",
        "DDOS Attack ": "#37B7EB ",
        "other ": "#37B7EB ",
        "0 to 3 ": "b54bcc ",
        "4 to 6 ": "b54bcc ",
        "7 to 9 ": "b54bcc ",
        "CVE 2010 1666 ": "f8afFF ",
        "CVE 2018 1024 ": "f8afFF ",
        "CVE 2015 512 ": "f8afFF ",

    };

    // Total size of all segments; we set this later, after loading the data.
    var totalSize = 0;

    var vis = d3.select("#sunburst ").append("svg:svg ")
        .attr("width ", width)
        .attr("height ", height)
        .append("svg:g ")
        .attr("id ", "container ")
        .attr("transform ", "translate( " + width / 2 + ", " + height / 2 + ") ");

    var partition = d3.layout.partition()
        .size([2 * Math.PI, radius * radius])
        .value(function(d) { return d.size; });

    var arc = d3.svg.arc()
        .startAngle(function(d) { return d.x; })
        .endAngle(function(d) { return d.x + d.dx; })
        .innerRadius(function(d) { return Math.sqrt(d.y); })
        .outerRadius(function(d) { return Math.sqrt(d.y + d.dy); });
    // Use d3.text and d3.csv.parseRows so that we do not need to have a header
    // row, and can receive the csv as an array of arrays.

    var text = "device risks-high-anomalies-FTP to external IPs,6\n\ device risks-medium-anomalies-Operational Warning,21\n\ device risks-high-anomalies-Botnet,39\n\ device risks-high-anomalies-DDOS Attack,10\n\ device risks-low-anomalies-other,67\n\ device risks-high-likelihood-7 to 9-CVE 2010 1666,4\n\ device risks-high-likelihood-7 to 9-CVE 2018 1024,2\n\ device risks-high-likelihood-7 to 9-CVE 2015 512,2\n\ device risks-medium-likelihood-4 to 6-CVE 2010 1666,13\n\ device risks-medium-likelihood-4 to 6-CVE 2018 1024,4\n\ device risks-medium-likelihood-4 to 6-CVE 2015 512,2\n\ device risks-low-likelihood-0 to 3-CVE 2010 1666,5\n\ device risks-low-likelihood-0 to 3-CVE 2018 1024,2\n\ device risks-low-likelihood-0 to 3-CVE 2015 512,12\n\ ";
    var csv = d3.csv.parseRows(text);
    var json = buildHierarchy(csv);
    createVisualization(json);


    // Main function to draw and set up the visualization, once we have the data.
    function createVisualization(json) {

        // Basic setup of page elements.
        initializeBreadcrumbTrail();
        drawLegend();
        d3.select("#togglelegend ").on("click ", toggleLegend);

        // Bounding circle underneath the sunburst, to make it easier to detect
        // when the mouse leaves the parent g.
        vis.append("svg:circle ")
            .attr("r ", radius)
            .style("opacity ", 0);

        // For efficiency, filter nodes to keep only those large enough to see.
        var nodes = partition.nodes(json)
            .filter(function(d) {
                return (d.dx > 0.005); // 0.005 radians = 0.29 degrees
            });

        var path = vis.data([json]).selectAll("path ")
            .data(nodes)
            .enter().append("svg:path ")
            .attr("display ", function(d) { return d.depth ? null : "none "; })
            .attr("d ", arc)
            .attr("fill-rule ", "evenodd ")
            .style("fill ", function(d) { return colors[d.name]; })
            .style("opacity ", 1)
            .on("mouseover ", mouseover);

        // Add the mouseleave handler to the bounding circle.
        d3.select("#container ").on("mouseleave ", mouseleave);

        // Get total size of the tree = value of root node from partition.
        totalSize = path.node().__data__.value;
    };

    // Fade all but the current sequence, and show it in the breadcrumb trail.
    function mouseover(d) {

        var percentage = d.value;
        var percentageString = percentage + " devices ";
        if (percentage < 0.1) {
            percentageString = "< 0.1%";
        }

        d3.select("#percentage ")
            .text(percentage);


        d3.select("#explanation ")
            .style("visibility ", " ");

        var sequenceArray = getAncestors(d);
        updateBreadcrumbs(sequenceArray, percentageString);

        // Fade all the segments.
        d3.selectAll("path ")
            .style("opacity ", 0.3);

        // Then highlight only those that are an ancestor of the current segment.
        vis.selectAll("path ")
            .filter(function(node) {
                return (sequenceArray.indexOf(node) >= 0);
            })
            .style("opacity ", 1);
    }

    // Restore everything to full opacity when moving off the visualization.
    function mouseleave(d) {

        // Hide the breadcrumb trail
        d3.select("#trail ")
            .style("visibility ", "hidden ");

        // Deactivate all segments during transition.
        d3.selectAll("path ").on("mouseover ", null);

        // Transition each segment to full opacity and then reactivate it.
        d3.selectAll("path ")
            .transition()
            .duration(1000)
            .style("opacity ", 1)
            .each("end ", function() {
                d3.select(this).on("mouseover ", mouseover);
            });

        d3.select("explanation ")
            .transition()
            .duration(1000)
            .style("visibility ", "hidden ");
    }

    // Given a node in a partition layout, return an array of all of its ancestor
    // nodes, highest first, but excluding the root.
    function getAncestors(node) {
        var path = [];
        var current = node;
        while (current.parent) {
            path.unshift(current);
            current = current.parent;
        }
        return path;
    }

    function initializeBreadcrumbTrail() {
        // Add the svg area.
        var trail = d3.select("#sequence ").append("svg:svg ")
            .attr("width ", width)
            .attr("height ", 50)
            .attr("id ", "trail ");
        // Add the label at the end, for the percentage.
        trail.append("svg:text ")
            .attr("id ", "endlabel ")
            .style("fill ", "#000 ");
    }

    // Generate a string that describes the points of a breadcrumb polygon.
    function breadcrumbPoints(d, i) {
        var points = [];
        points.push("0,0 ");
        points.push(b.w + ",0 ");
        points.push(b.w + b.t + ", " + (b.h / 2));
        points.push(b.w + ", " + b.h);
        points.push("0, " + b.h);
        if (i > 0) { // Leftmost breadcrumb; don't include 6th vertex.
            points.push(b.t + ", " + (b.h / 2));
        }
        return points.join(" ");
    }

    // Update the breadcrumb trail to show the current sequence and percentage.
    function updateBreadcrumbs(nodeArray, percentageString) {

        // Data join; key function combines name and depth (= position in sequence).
        var g = d3.select("#trail ")
            .selectAll("g ")
            .data(nodeArray, function(d) { return d.name + d.depth; });

        // Add breadcrumb and label for entering nodes.
        var entering = g.enter().append("svg:g ");

        entering.append("svg:polygon ")
            .attr("points ", breadcrumbPoints)
            .style("fill ", function(d) { return colors[d.name]; });

        entering.append("svg:text ")
            .attr("x ", (b.w + b.t) / 2)
            .attr("y ", b.h / 2)
            .attr("dy ", "0.35em ")
            .attr("text-anchor ", "middle ")
            .text(function(d) { return d.name; });

        // Set position for entering and updating nodes.
        g.attr("transform ", function(d, i) {
            return "translate( " + i * (b.w + b.s) + ", 0) ";
        });

        // Remove exiting nodes.
        g.exit().remove();

        // Now move and update the percentage at the end.
        d3.select("#trail ").select("#endlabel ")
            .attr("x ", (nodeArray.length + 0.5) * (b.w + b.s))
            .attr("y ", b.h / 2)
            .attr("dy ", "0.35em ")
            .attr("text-anchor ", "middle ")
            .text(percentageString);

        // Make the breadcrumb trail visible, if it's hidden.
        d3.select("#trail ")
            .style("visibility ", " ");

    }

    function drawLegend() {

        // Dimensions of legend item: width, height, spacing, radius of rounded rect.
        var li = {
            w: 150,
            h: 30,
            s: 3,
            r: 3
        };

        var legend = d3.select("#legend ").append("svg:svg ")
            .attr("width ", li.w)
            .attr("height ", d3.keys(colors).length * (li.h + li.s));

        var g = legend.selectAll("g ")
            .data(d3.entries(colors))
            .enter().append("svg:g ")
            .attr("transform ", function(d, i) {
                return "translate(0, " + i * (li.h + li.s) + ") ";
            });

        g.append("svg:rect ")
            .attr("rx ", li.r)
            .attr("ry ", li.r)
            .attr("width ", li.w)
            .attr("height ", li.h)
            .style("fill ", function(d) { return d.value; });

        g.append("svg:text ")
            .attr("x ", li.w / 2)
            .attr("y ", li.h / 2)
            .attr("dy ", "0.35em ")
            .attr("text-anchor ", "middle ")
            .text(function(d) { return d.key; });
    }

    function toggleLegend() {
        var legend = d3.select("#legend ");
        if (legend.style("visibility ") == "hidden ") {
            legend.style("visibility ", " ");
        } else {
            legend.style("visibility ", "hidden ");
        }
    }

    // Take a 2-column CSV and transform it into a hierarchical structure suitable
    // for a partition layout. The first column is a sequence of step names, from
    // root to leaf, separated by hyphens. The second column is a count of how 
    // often that sequence occurred.
    function buildHierarchy(csv) {
        var root = { "name ": "root ", "children ": [] };
        for (var i = 0; i < csv.length; i++) {
            var sequence = csv[i][0];
            var size = +csv[i][1];
            if (isNaN(size)) { // e.g. if this is a header row
                continue;
            }
            var parts = sequence.split("- ");
            var currentNode = root;
            for (var j = 0; j < parts.length; j++) {
                var children = currentNode["children "];
                var nodeName = parts[j];
                var childNode;
                if (j + 1 < parts.length) {
                    // Not yet at the end of the sequence; move down the tree.
                    var foundChild = false;
                    for (var k = 0; k < children.length; k++) {
                        if (children[k]["name "] == nodeName) {
                            childNode = children[k];
                            foundChild = true;
                            break;
                        }
                    }
                    // If we don't already have a child node for this branch, create it.
                    if (!foundChild) {
                        childNode = { "name ": nodeName, "children ": [] };
                        children.push(childNode);
                    }
                    currentNode = childNode;
                } else {
                    // Reached the end of the sequence; create a leaf node.
                    childNode = { "name ": nodeName, "size ": size };
                    children.push(childNode);
                }
            }
        }
        return root;
    };
    </script>

</body>

</html>